<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>filter_by_metadata.py – Filter OTU table by removal of specified metadata &mdash; Homepage</title>
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.1.0',
        COLLAPSE_MODINDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="top" title="Homepage" href="../index.html" />     
<meta http-equiv="Content-Style-Type" content="text/css" />
<script type="text/javascript" src="http://www.google.com/jsapi?key=ABQIAAAAbW_pA971hrPgosv-Msv7hRRE2viNBUPuU405tK6p2cguOFmlFBQSwZMG6_q_v6Z42nkdo9ejT1aHmA"></script>
<script type="text/javascript" src="../_static/google_feed.js"></script>

  </head>
  <body>

<div style="background-color: white; text-align: left; padding: 0px">
<a href="../index.html"><img src="../_static/wordpressheader.png" border="0" alt="sampledoc"/></a>
</div>
<div class="news" style="background-color:#ccc;"><table style="font-size:12pt;padding: 5px;"><tr id="feed"><td><b>News and Announcements &raquo;</b></td>
</tr></table></div>

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li><a href="../index.html">Home</a> &raquo;</li> 
      </ul>
    </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <span class="target" id="filter-by-metadata"></span><div class="section" id="filter-by-metadata-py-filter-otu-table-by-removal-of-specified-metadata">
<span id="index-25"></span><h1><em>filter_by_metadata.py</em> &#8211; Filter OTU table by removal of specified metadata<a class="headerlink" href="#filter-by-metadata-py-filter-otu-table-by-removal-of-specified-metadata" title="Permalink to this headline">¶</a></h1>
<p><strong>Description:</strong></p>
<p>This filter allows for the removal of sequences and OTUs that either do or don&#8217;t match specified metadata, for instance, isolating samples from a specific set of studies or body sites. This script identifies samples matching the specified metadata criteria, and outputs a filtered mapping file and OTU table containing only the specified samples.</p>
<p><strong>Usage:</strong> <tt class="docutils literal"><span class="pre">filter_by_metadata.py</span> <span class="pre">[options]</span></tt></p>
<p><strong>Input Arguments:</strong></p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p><strong>[REQUIRED]</strong></p>
<dl class="docutils">
<dt>-i, <cite>-</cite>-otu_table_fp</dt>
<dd>Path to the input OTU table (i.e., the output from <a class="reference external" href="./make_otu_table.html">make_otu_table.py</a>)</dd>
<dt>-m, <cite>-</cite>-map</dt>
<dd>Path to the map file [REQUIRED]</dd>
<dt>-s, <cite>-</cite>-states</dt>
<dd>String containing valid states, e.g. &#8216;STUDY_NAME:DOG&#8217;</dd>
</dl>
<p><strong>[OPTIONAL]</strong></p>
<dl class="last docutils">
<dt>-o, <cite>-</cite>-otu_outfile</dt>
<dd>Name of otu output file, default is otu_filename.filtered.xls</dd>
<dt>-p, <cite>-</cite>-map_outfile</dt>
<dd>Name of map output file, default is map_filename.filtered.xls</dd>
<dt>-n, <cite>-</cite>-num_seqs_per_otu</dt>
<dd>Minimum counts across samples to keep OTU, default is only to keep OTUs that are present in the samples.</dd>
</dl>
</div>
<p><strong>Output:</strong></p>
<p>The result is a filtered OTU table and mapping file meeting the desired criteria.</p>
<p><strong>Examples:</strong></p>
<p>The following command can be used, where all options are passed (using the resulting OTU file from <a class="reference external" href="./make_otu_table.html">make_otu_table.py</a>, the original Fasting_Map.txt, and keeping only the Control sequences in the Treatment field) with the resulting data being written to seqs_otus.txt.filtered.xls and Fasting_Map.txt.filtered.xls:</p>
<div class="highlight-python"><pre>filter_by_metadata.py -i seqs_otus.txt -m Fasting_Map.txt -s 'Treatment:Control'</pre>
</div>
<p>Some variations (not so useful on this dataset, but more useful on larger datasets) are:</p>
<p>Keeping both Control and Fast in the Treatment field (i.e. keeping everything):</p>
<div class="highlight-python"><pre>filter_by_metadata.py -i seqs_otus.txt -m Fasting_Map.txt -s 'Treatment:Control,Fast'</pre>
</div>
<p>Excluding Fast in the Treatment field (same as the first example) - the syntax here is &#8220;*&#8221; to keep everything, then !Fast to eliminate the Fast group:</p>
<div class="highlight-python"><pre>filter_by_metadata.py -i seqs_otus.txt -m Fasting_Map.txt -s 'Treatment:*,!Fast'</pre>
</div>
<p>Keeping only samples with both Control in the Treatment field and 20061218 in the DOB field:</p>
<div class="highlight-python"><pre>filter_by_metadata.py -i seqs_otus.txt -m Fasting_Map.txt -s 'Treatment:Control;DOB:20061218'</pre>
</div>
<p>Keeping only samples with Control in the Treatment field and OTUs with counts of at least 5 across samples:</p>
<div class="highlight-python"><pre>filter_by_metadata.py -i seqs_otus.txt -m Fasting_Map.txt -s 'Treatment:Control' -n 5</pre>
</div>
<p>Note that the filtered mapping file will automatically exclude any columns that are the same for all the samples that are left, and will also exclude (except for SampleID) any columns that are different for all the samples that are left, making it more useful for downstream analyses with the coloring tools.</p>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">

    

	<h3><a href="../index.html">Site index</a></h3>
	<ul><li><ul>
		
	 <li><a href="../index.html">Home</a><br /></li>
	 <li><a href="../install/index.html">Install</a><br /></li>
	 <li><a href="../documentation/index.html">Documentation</a><br /></li>
	 <li><a href="../tutorials/index.html">Tutorials</a><br /></li>
	 <li><a href="http://qiime.wordpress.com">Blog</a><br /></li>
	 <li><a href="../developer/index.html">Developer</a><br /></li>
	</ul></li></ul>


          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="../search.html" method="get">
                <input type="text" name="q" size="18" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li><a href="../index.html">Home</a> &raquo;</li> 
      </ul>
    </div>

    <div class="footer">
      &copy; Copyright 2010, QIIME Team.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 0.6.3.
    </div>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-6636235-4");
pageTracker._trackPageview();
} catch(err) {}</script>

  </body>
</html>