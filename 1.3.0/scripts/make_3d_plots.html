

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>make_3d_plots.py – Make 3D PCoA plots &mdash; Homepage</title>
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.3.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="top" title="Homepage" href="../index.html" />     
<meta http-equiv="Content-Style-Type" content="text/css" />
<script type="text/javascript" src="http://www.google.com/jsapi?key=ABQIAAAAbW_pA971hrPgosv-Msv7hRRE2viNBUPuU405tK6p2cguOFmlFBQSwZMG6_q_v6Z42nkdo9ejT1aHmA"></script>
<script type="text/javascript" src="../_static/google_feed.js"></script>

  </head>
  <body>

<div style="background-color: white; text-align: left; padding: 0px">
<a href="../index.html"><img src="../_static/wordpressheader.png" border="0" alt="sampledoc"/></a>
</div>
<div class="news" style="background-color:#ccc;"><table style="font-size:12pt;padding: 5px;"><tr id="feed"><td><b>News and Announcements &raquo;</b></td>
</tr></table></div>

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li><a href="../index.html">Home</a> &raquo;</li> 
      </ul>
    </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <span class="target" id="make-3d-plots"></span><div class="section" id="make-3d-plots-py-make-3d-pcoa-plots">
<span id="index-0"></span><h1><em>make_3d_plots.py</em> &#8211; Make 3D PCoA plots<a class="headerlink" href="#make-3d-plots-py-make-3d-pcoa-plots" title="Permalink to this headline">¶</a></h1>
<p><strong>Description:</strong></p>
<p>This script automates the construction of 3D plots (kinemage format) from the PCoA output file generated by <a class="reference external" href="./principal_coordinates.html">principal_coordinates.py</a> (e.g. P1 vs. P2 vs. P3, P2 vs. P3 vs. P4, etc., where P1 is the first component).</p>
<p><strong>Usage:</strong> <tt class="file docutils literal"><span class="pre">make_3d_plots.py</span> <span class="pre">[options]</span></tt></p>
<p><strong>Input Arguments:</strong></p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p><strong>[REQUIRED]</strong></p>
<dl class="docutils">
<dt>-i, <cite>-</cite>-coord_fname</dt>
<dd>Input principal coordinates filepath (i.e., resulting file from <a class="reference external" href="./principal_coordinates.html">principal_coordinates.py</a>).  Alternatively, a directory containing multiple principal coordinates files for jackknifed PCoA results.</dd>
<dt>-m, <cite>-</cite>-map_fname</dt>
<dd>Input metadata mapping filepath</dd>
</dl>
<p><strong>[OPTIONAL]</strong></p>
<dl class="last docutils">
<dt>-b, <cite>-</cite>-colorby</dt>
<dd>Comma-separated list categories metadata categories (column headers) to color by in the plots. The categories must match the name of a column header in the mapping file exactly. Multiple categories can be list by comma separating them without spaces. The user can also combine columns in the mapping file by separating the categories by &#8220;&amp;&amp;&#8221; without spaces. [default=color by all]</dd>
<dt>-a, <cite>-</cite>-custom_axes</dt>
<dd>This is the category from the metadata mapping file to use as a custom axis in the plot.  For instance, if there is a pH category and you would like to see the samples plotted on that axis instead of PC1, PC2, etc., one can use this option.  It is also useful for plotting time-series data. Note: if there is any non-numeric data in the column, it will not be plotted [default: None]</dd>
<dt>-p, <cite>-</cite>-prefs_path</dt>
<dd>Input user-generated preferences filepath. NOTE: This is a file with a dictionary containing preferences for the analysis. [default: None]</dd>
<dt>-k, <cite>-</cite>-background_color</dt>
<dd>Background color to use in the plots. [default: black]</dd>
<dt><cite>-</cite>-ellipsoid_smoothness</dt>
<dd>Used only when plotting ellipsoids for jackknifed beta diversity (i.e. using a directory of coord files instead of a single coord file). Valid choices are 0-3. A value of 0 produces very coarse &#8220;ellipsoids&#8221; but is fast to render. If you encounter a memory error when generating or displaying the plots, try including just one metadata column in your plot. If you still have trouble, reduce the smoothness level to 0. [default: 1]</dd>
<dt><cite>-</cite>-ellipsoid_opacity</dt>
<dd>Used only when plotting ellipsoids for jackknifed beta diversity (i.e. using a directory of coord files instead of a single coord file). The valid range is between 0-1. 0 produces completely transparent (invisible) ellipsoids and 1 produces completely opaque ellipsoids. [default=0.33]</dd>
<dt><cite>-</cite>-ellipsoid_method</dt>
<dd>Used only when plotting ellipsoids for jackknifed beta diversity (i.e. using a directory of coord files instead of a single coord file). Valid values are &#8220;IQR&#8221; and &#8220;sdev&#8221;. [default=IQR]</dd>
<dt><cite>-</cite>-master_pcoa</dt>
<dd>Used only when plotting ellipsoids for jackknifed beta diversity (i.e. using a directory of coord files instead of a single coord file). These coordinates will be the center of each ellipisoid. [default: None; arbitrarily chosen PC matrix will define the center point]</dd>
<dt>-t, <cite>-</cite>-taxa_fname</dt>
<dd>Used only when generating BiPlots. Input summarized taxa filepath (i.e., from <a class="reference external" href="./summarize_taxa.html">summarize_taxa.py</a>). Taxa will be plotted with the samples. [default=None]</dd>
<dt><cite>-</cite>-n_taxa_keep</dt>
<dd>Used only when generating BiPlots. This is the number of taxa  to display. Use -1 to display all. [default: 10]</dd>
<dt><cite>-</cite>-biplot_output_file</dt>
<dd>Used only when generating BiPlots. Output coordinates filepath  when generating a biplot. [default: None]</dd>
<dt><cite>-</cite>-output_format</dt>
<dd>Output format. If this option is set to invue you will need to also use the option -b to define which column(s) from the metadata file the script should use when writing an output file. [default: king]</dd>
<dt>-n, <cite>-</cite>-interpolation_points</dt>
<dd>Used only when generating inVUE plots. Number of points between samples for interpolatation. [default: 0]</dd>
<dt><cite>-</cite>-polyhedron_points</dt>
<dd>Used only when generating inVUE plots. The number of points to be generated when creating a frame around the PCoA plots. [default: 4]</dd>
<dt><cite>-</cite>-polyhedron_offset</dt>
<dd>Used only when generating inVUE plots. The offset to be added to each point created when using the &#8211;polyhedron_points option. This is only used when using the invue output_format. [default: 1.5]</dd>
<dt>-o, <cite>-</cite>-output_dir</dt>
<dd>Path to the output directory</dd>
</dl>
</div>
<p><strong>Output:</strong></p>
<p>By default, the script will plot the first three dimensions in your file. Other combinations can be viewed using the &#8220;Views:Choose viewing axes&#8221; option in the KiNG viewer (Chen, Davis, &amp; Richardson, 2009), which may require the installation of kinemage software. The first 10 components can be viewed using &#8220;Views:Paralled coordinates&#8221; option or typing &#8220;/&#8221;. The mouse can be used to modify display parameters, to click and rotate the viewing axes, to select specific points (clicking on a point shows the sample identity in the low left corner), or to select different analyses (upper right window). Although samples are most easily viewed in 2D, the third dimension is indicated by coloring each sample (dot/label) along a gradient corresponding to the depth along the third component (bright colors indicate points close to the viewer).</p>
<p><strong>Default Usage:</strong></p>
<p>If you just want to use the default output, you can supply the principal coordinates file (i.e., resulting file from <a class="reference external" href="./principal_coordinates.html">principal_coordinates.py</a>) and a user-generated mapping file, where the default coloring will be based on the SampleID as follows:</p>
<div class="highlight-python"><pre>make_3d_plots.py -i beta_div_coords.txt -m Mapping_file.txt</pre>
</div>
<p>Additionally, the user can supply their mapping file (&#8220;-m&#8221;) and a specific category to color by (&#8220;-b&#8221;) or any combination of categories. When using the -b option, the user can specify the coloring for multiple mapping labels, where each mapping label is separated by a comma, for example: -b &#8216;mapping_column1,mapping_column2&#8217;. The user can also combine mapping labels and color by the combined label that is created by inserting an &#8216;&amp;&amp;&#8217; between the input columns, for example: -b &#8216;mapping_column1&amp;&amp;mapping_column2&#8217;.</p>
<p>If the user would like to color all categories in their metadata mapping file, they can pass &#8216;ALL&#8217; to the &#8216;-b&#8217; option, as follows:</p>
<div class="highlight-python"><pre>make_3d_plots.py -i beta_div_coords.txt -m Mapping_file.txt -b ALL</pre>
</div>
<p>As an alternative, the user can supply a preferences (prefs) file, using the -p option. The prefs file allows the user to give specific samples their own columns within a given mapping column. This file also allows the user to perform a color gradient, given a specific mapping column.</p>
<p>If the user wants to color by using the prefs file (e.g. prefs.txt), they can use the following code:</p>
<div class="highlight-python"><pre>make_3d_plots.py -i beta_div_coords.txt -m Mapping_file.txt -p prefs.txt</pre>
</div>
<p><strong>Output Directory:</strong></p>
<p>If you want to give an specific output directory (e.g. &#8220;3d_plots&#8221;), use the following code:</p>
<div class="highlight-python"><pre>make_3d_plots.py -i principal_coordinates-output_file --o 3d_plots/</pre>
</div>
<p><strong>Background Color Example:</strong></p>
<p>If the user would like to color the background white they can use the &#8216;-k&#8217; option as follows:</p>
<div class="highlight-python"><pre>make_3d_plots.py -i beta_div_coords.txt -m Mapping_file.txt -b ALL -k white</pre>
</div>
<p><strong>Jackknifed Principal Coordinates (w/ confidence intervals):</strong></p>
<p>If you have created jackknifed PCoA files, you can pass the folder containing those files, instead of a single file.  The user can also specify the opacity of the ellipses around each point &#8220;&#8211;ellipsoid_opacity&#8221;, which is a value from 0-1. Currently there are two metrics &#8220;&#8211;ellipsoid_method&#8221; that can be used for generating the ellipsoids, which are &#8216;IQR&#8217; and &#8216;sdev&#8217;. The user can specify all of these options as follows:</p>
<div class="highlight-python"><pre>make_3d_plots.py -i jackknifed_pcoas/ -m Mapping_file.txt -b 'mapping_column1,mapping_column1&amp;&amp;mapping_column2' --ellipsoid_opacity=0.5 --ellipsoid_method=IQR</pre>
</div>
<p><strong>Bi-Plots:</strong></p>
<p>If the user would like to see which taxa are more prevalent in different areas of the PCoA plot, they can generate Bi-Plots, by passing a principal coordinates file or folder &#8220;-i&#8221;, a mapping file &#8220;-m&#8221;, and a summarized taxa file &#8220;-t&#8221; from <a class="reference external" href="./summarize_taxa.html">summarize_taxa.py</a>. Can be combined with jacknifed principal coordinates.</p>
<div class="highlight-python"><pre>make_3d_plots.py -i pcoa.txt -m Mapping_file.txt -t otu_table_level3.txt</pre>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">

    

	<h3><a href="../index.html">Site index</a></h3>
	<ul><li><ul>
	<li><a href="../index.html">Home</a><br /></li>
	<li><a href="../install/index.html">Install</a><br /></li>
	<li><a href="../documentation/index.html">Documentation</a><br /></li>
	<li><a href="../tutorials/index.html">Tutorials</a><br /></li>
	<li><a href="http://qiime.wordpress.com">Blog</a><br /></li>
	<li><a href="../developer/index.html">Developer</a><br /></li>
	</ul></li></ul>


<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li><a href="../index.html">Home</a> &raquo;</li> 
      </ul>
    </div>
<div style="text-align: center; padding: 0px;"><br />
<a href="http://pycogent.sourceforge.net" target="_blank"><img src="../_static/PoweredByPycogent.jpg" border="0" alt="sampledoc" height="70px"/></a>
<br /></div>

    <div class="footer">
        &copy; Copyright 2011, QIIME Team.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.0.7.
    </div>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-6636235-4");
pageTracker._trackPageview();
} catch(err) {}</script>

  </body>
</html>