

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Performing Procrustes Analysis &mdash; Homepage</title>
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.4.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="top" title="Homepage" href="../index.html" />     
<meta http-equiv="Content-Style-Type" content="text/css" />
<script type="text/javascript" src="http://www.google.com/jsapi?key=ABQIAAAAbW_pA971hrPgosv-Msv7hRRE2viNBUPuU405tK6p2cguOFmlFBQSwZMG6_q_v6Z42nkdo9ejT1aHmA"></script>
<script type="text/javascript" src="../_static/google_feed.js"></script>

  </head>
  <body>

<div style="background-color: white; text-align: left; padding: 0px">
<a href="../index.html"><img src="../_static/wordpressheader.png" border="0" alt="sampledoc"/></a>
</div>
<div class="news" style="background-color:#ccc;"><table style="font-size:12pt;padding: 5px;"><tr id="feed"><td><b>News and Announcements &raquo;</b></td>
</tr></table></div>

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li><a href="../index.html">Home</a> &raquo;</li> 
      </ul>
    </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="performing-procrustes-analysis">
<span id="procrustes-analysis"></span><h1>Performing Procrustes Analysis<a class="headerlink" href="#performing-procrustes-analysis" title="Permalink to this headline">¶</a></h1>
<p>This tutorial covers how to perform Procrustes Analysis using Qiime to compare beta diversity plots generated by two different mechanisms. Procrustes analysis takes as input two coordinate matrices (in Qiime, these are usually the results of running a principal coordinates analysis on a sample-by-sample distance matrix), and transforms the second coordinate set to minimize the distances between corresponding points. The results can then be visualized using Qiime by running <tt class="docutils literal"><span class="pre">compare_3d_plots.py</span></tt> &#8211; both sets of coordinates will be plotted in the resulting figure, with bars connecting the corresponding points from each data set.</p>
<p>For example, Figure 1 is a plot that was generated by comparing two different sets of reads from the same collection of samples. The idea behind this study was to evaluate whether the same beta diversity conclusions would be derived from different read types. Bars connect points from the same sample, where each point represents one read type. Colors, as usual in Qiime 3D plots, indicate sample type (for example, dark blue represents 5 fecal samples). The two read types compared are the 5&#8217; reads and the 3&#8217; reads from a paired-end Illumina run. The results here illustrate that the 3D plot derived from each read type is essentially identical, and the different read types would certainly not lead to different conclusions.</p>
<div class="figure">
<a class="reference internal image-reference" href="../_images/procrustes_tutorial_figure1.png"><img alt="../_images/procrustes_tutorial_figure1.png" src="../_images/procrustes_tutorial_figure1.png" /></a>
<p class="caption">Figure 1: Procrustes comparison of unweighted UniFrac PCoA plots derived from 5&#8217; and 3&#8217; reads from a paired-end Illumina run. A discussion of this analysis can be found in Caporaso et al., PNAS (2010), &#8220;Global patterns of 16S rRNA diversity at a depth of millions of sequences per sample&#8221;.</p>
</div>
<p>To visualize procrustes results on two principal coordinate matrices with overlapping sample IDs, you can run the following command:</p>
<div class="highlight-python"><pre>transform_coordinate_matrices.py -i pcoa1.txt,pcoa2.txt -o procrustes/</pre>
</div>
<p>In this example `` pcoa1.txt`` and <tt class="docutils literal"><span class="pre">pcoa2.txt</span></tt> are your two principal coordinate matrices. Note that these are comma-separated with no spaces between them. The output will be two transformed principal coordinate matrices which can be provided to <tt class="docutils literal"><span class="pre">compare_3d_plots.py</span></tt> with the command:</p>
<div class="highlight-python"><pre>compare_3d_plots.py -i procrustes/pc1_transformed.txt,procrustes/pc2_transformed.txt -m mapping_file.txt -o plots/</pre>
</div>
<p>The 3D Procrustes plots will be written to <tt class="docutils literal"><span class="pre">plots/</span></tt>.</p>
<div class="section" id="generating-monte-carlo-p-values-for-procrustes-analysis">
<h2>Generating Monte Carlo p-values for Procrustes analysis<a class="headerlink" href="#generating-monte-carlo-p-values-for-procrustes-analysis" title="Permalink to this headline">¶</a></h2>
<p>Transform coordinate matrices also supports generation of monte carlo p-values based on a user-specified number of repetitions. To generate this data, you could modify your <tt class="docutils literal"><span class="pre">transform_coordinate_matrices.py</span></tt> command by appending the -r parameter as:</p>
<div class="highlight-python"><pre>transform_coordinate_matrices.py -i pcoa1.txt,pcoa2.txt -o procrustes/ -r 1000</pre>
</div>
<p>This specifies that 1000 repetitions should be run. The output of this analysis will be in the output directory in a file named based on the input files (<tt class="docutils literal"><span class="pre">procrustes/pcoa1_pcoa2__procrustes_results.txt</span></tt> in this example).</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">

    
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Performing Procrustes Analysis</a><ul>
<li><a class="reference internal" href="#generating-monte-carlo-p-values-for-procrustes-analysis">Generating Monte Carlo p-values for Procrustes analysis</a></li>
</ul>
</li>
</ul>


	<h3><a href="../index.html">Site index</a></h3>
	<ul><li><ul>
	<li><a href="../index.html">Home</a><br /></li>
	<li><a href="../install/index.html">Install</a><br /></li>
	<li><a href="../documentation/index.html">Documentation</a><br /></li>
	<li><a href="index.html">Tutorials</a><br /></li>
	<li><a href="http://qiime.wordpress.com">Blog</a><br /></li>
	<li><a href="../developer/index.html">Developer</a><br /></li>
	</ul></li></ul>


<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li><a href="../index.html">Home</a> &raquo;</li> 
      </ul>
    </div>
<div style="text-align: center; padding: 0px;"><br />
<a href="http://pycogent.sourceforge.net" target="_blank"><img src="../_static/PoweredByPycogent.jpg" border="0" alt="sampledoc" height="70px"/></a>
<br /></div>

    <div class="footer">
        &copy; Copyright 2011, QIIME Team.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.0.7.
    </div>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-6636235-4");
pageTracker._trackPageview();
} catch(err) {}</script>

  </body>
</html>